rules:
  - id: week-hashing-md5
    languages:
      - java
    severity: ERROR
    metadata:
      cwe:
        - "CWE-CWE-798: Use of Hard-coded Credentials"
    message: Weak password!the password is either stored in plaintext or hashed using a weak or outdated algorithm like MD5.
    pattern-either:
      - pattern: "MessageDigest $MD=MessageDigest.getInstance(...);\r

          ...\r

          $MD.update(...);"
      - pattern: String $VAR= $VAL;