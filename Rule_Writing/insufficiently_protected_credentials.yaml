rules:
  - id: jwt-insecure-algorithm
    languages:
      - js
    severity: ERROR
    message: |
     Insecure JWT signing algorithm detected. Use a secure algorithm like 'RS256'.
     For details on how to implement `RS256`:https://jwt.io/introduction/
    patterns:
      - pattern: var $TOKEN =jwt.sign(...,{algorithm:'$X'})
      - metavariable-regex:
          metavariable: $X
          regex: none|HS256|HS384|HS512|ES256
